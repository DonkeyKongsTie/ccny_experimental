<!-- ComplementaryFilter launch file -->
<launch>
  #### Nodelet manager ######################################################

  <node pkg="nodelet" type="nodelet" name="imu_manager" 
    args="manager" output="screen" />

  #### IMU Driver ###########################################################

  <node pkg="nodelet" type="nodelet" name="PhidgetsImuNodelet" 
    args="load phidgets_imu/PhidgetsImuNodelet imu_manager" 
    output="screen">

    # supported data rates: 4 8 16 24 32 40 ... 1000 (in ms)
    <param name="period" value="4"/>

  </node>

  #### Complementary filter

  <node pkg="imu_complementary_filter" type="complementary_filter_node"
      name="complementary_filter_node" output="screen">
    <param name="do_bias_estimation" value="false"/>
    <param name="do_adaptive_gain" value="false"/>
    <param name="use_mag" value="false"/>
    <param name="gain_acc" value="0.01"/>
    <param name="gain_mag" value="0.01"/>
  </node>

  <node pkg="imu_complementary_filter" type="complementary_filter_node"
      name="complementary_filter_gain_node" output="screen">
    <param name="do_bias_estimation" value="true"/>
    <param name="do_adaptive_gain" value="false"/>
    <param name="use_mag" value="false"/>
    <param name="gain_acc" value="0.01"/>
    <param name="gain_mag" value="0.01"/>
  
    <remap from="/imu/roll"  to="/imu/roll_gain"/>
    <remap from="/imu/pitch" to="/imu/pitch_gain"/>
    <remap from="/imu/yaw"   to="/imu/yaw_gain"/>
  </node>

  #### Madgwick filter

  <node pkg="imu_filter_madgwick" type="imu_filter_node" name="imu_filter_node"
    output="screen">
    <param name="use_mag" value="false"/>
    <param name="gain" value="0.1"/>
    <remap from="imu/data" to="imu/data_madgwick"/>
  </node>

</launch>
